<div class="container">
  <h1>{{ isAdmin ? 'All Orders' : 'My Orders' }}</h1>

  <!-- Loading State -->
  <div class="loading" *ngIf="loading">
    <p>Loading orders...</p>
  </div>

  <!-- Error State -->
  <div class="error-message" *ngIf="error">
    <p>{{ error }}</p>
  </div>

  <!-- Empty State -->
  <div class="orders-empty" *ngIf="!loading && !error && groupedOrders.length === 0">
    <h2>{{ isAdmin ? 'No orders found' : 'No orders yet' }}</h2>
    <p>{{ isAdmin ? 'No customers have placed orders yet.' : 'Start shopping to see your orders here!' }}</p>
    <button class="btn btn-primary" routerLink="/product">Browse Products</button>
  </div>

  <!-- Orders List -->
  <div class="orders-list" *ngIf="!loading && !error && groupedOrders.length > 0">
    <div class="order-card" *ngFor="let order of groupedOrders">
      <!-- Order Header -->
      <div class="order-header">
        <div class="order-info">
          <h3>Order #{{ order.orderId }}</h3>
          <p class="order-date">{{ formatDate(order.created) }}</p>
          <p class="customer-name">Customer: {{ order.customerName }}</p>
        </div>
        <div class="order-status">
          <span class="status-badge" [ngClass]="getStatusClass(order.items[0].orderStatus, order.items[0].status)">
            {{ getStatusBadge(order.items[0].orderStatus, order.items[0].status) }}
          </span>
          <p class="order-total">₱{{ order.total.toFixed(2) }}</p>
        </div>
      </div>

      <!-- Order Items -->
      <div class="order-items">
        <div class="order-item" *ngFor="let item of order.items">
          <img [src]="getProductImage(item.productImageFile)" 
               [alt]="item.productName" 
               class="item-image">
          <div class="item-details">
            <h4>{{ item.productName }}</h4>
            <p class="item-category">{{ item.productCategoryName }}</p>
            <p class="item-description">{{ item.productDescription }}</p>
          </div>
          <div class="item-quantity">
            <p>Qty: {{ item.quantity }}</p>
          </div>
          <div class="item-price">
            <p>₱{{ item.price.toFixed(2) }}</p>
            <p class="item-total">₱{{ (item.price * item.quantity).toFixed(2) }}</p>
          </div>
        </div>
      </div>

      <!-- Order Footer -->
      <div class="order-footer">
        <div class="order-summary">
          <div class="summary-row">
            <span>Items:</span>
            <span>{{ order.items.length }}</span>
          </div>
          <div class="summary-row">
            <span>Subtotal:</span>
            <span>₱{{ (order.total / 1.08).toFixed(2) }}</span>
          </div>
          <div class="summary-row">
            <span>Tax (8%):</span>
            <span>₱{{ (order.total - (order.total / 1.08)).toFixed(2) }}</span>
          </div>
          <div class="summary-row total">
            <span>Total:</span>
            <span>₱{{ order.total.toFixed(2) }}</span>
          </div>
        </div>
        
        <!-- Admin Controls -->
        <div class="admin-controls" *ngIf="isAdmin && order.items[0].orderStatus === 'PENDING'">
          <h4>Admin Actions:</h4>
          <div class="admin-buttons">
            <button class="btn btn-success" (click)="acceptOrder(order.items[0].id!)">
              Accept 
            </button>
            <button class="btn btn-danger" (click)="rejectOrder(order.items[0].id!)">
              Reject
            </button>
            <button class="btn btn-info" (click)="processOrder(order.items[0].id!)">
              Processing
            </button>
          </div>
        </div>
        
        <!-- Admin Notes Display -->
        <div class="admin-notes" *ngIf="isAdmin && order.items[0].adminNotes">
          <h4>Admin Notes:</h4>
          <p>{{ order.items[0].adminNotes }}</p>
        </div>
      </div>

